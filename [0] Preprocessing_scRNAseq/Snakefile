import datetime
DATE = datetime.date.today().strftime("%Y%m%d")


# Setup config and functions ===================================================
# Use docker image
# container: "docker://f06b22037/bioinfobase:latest"

# Load configuration file (as config)
configfile: "./configs/config.json"

# Include rules
include: "rules/SS_single_cell.smk"
include: "rules/MS_single_cell_anchor.smk"


# Define rules for execution ===================================================


rule PtrVert1:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_Ptr",
                "TenX_PtrVertical01"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrVert1"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrVert1"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )


rule PtrVert2:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_Ptr",
                "TenX_PtrVertical02"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrVert2"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrVert2"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )


rule PtrTensionWoodALL_13samples:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_Ptr",
                "TenX_PtrVertical01",
                "TenX_PtrVertical02",
                "TenX_PtrVertical03",
                "TenX_PtrVertical04",
                "TenX_PtrTW",
                "TenX_PtrTension02",
                "TenX_PtrTension03",
                "TenX_PtrTension04",
                "TenX_PtrOW",
                "TenX_PtrOpposite02",
                "TenX_PtrOpposite03",
                "TenX_PtrOpposite04"        
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrTensionWoodALL_13samples"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrTensionWoodALL_13samples"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )





rule PtrTens12_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrTW",
                "TenX_PtrTension02"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrTens12_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrTens12_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )

rule PtrTens13_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrTW",
                "TenX_PtrTension03"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrTens13_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrTens13_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )

rule PtrTens14_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrTW",
                "TenX_PtrTension04"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrTens14_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrTens14_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )


rule PtrTens23_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrTension02",
                "TenX_PtrTension03"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrTens23_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrTens23_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )


rule PtrTens24_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrTension02",
                "TenX_PtrTension04"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrTens24_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrTens24_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )


rule PtrTens34_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrTension03",
                "TenX_PtrTension04"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrTens34_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrTens34_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )


rule PtrOp12_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrOW",
                "TenX_PtrOpposite02"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrOp12_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrOp12_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )

rule PtrOp13_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrOW",
                "TenX_PtrOpposite03"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrOp13_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrOp13_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )

rule PtrOp14_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrOW",
                "TenX_PtrOpposite04"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrOp14_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrOp14_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )


rule PtrOp23_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrOpposite02",
                "TenX_PtrOpposite03"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrOp23_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrOp23_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )


rule PtrOp24_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrOpposite02",
                "TenX_PtrOpposite04"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrOp24_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrOp24_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )


rule PtrOp34_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrOpposite03",
                "TenX_PtrOpposite04"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrOp34_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrOp34_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )

rule PtrVert12_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrVertical01",
                "TenX_PtrVertical02"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrVert12_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrVert12_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )

rule PtrVert13_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrVertical01",
                "TenX_PtrVertical03"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrVert13_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrVert13_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )

rule PtrVert14_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrVertical01",
                "TenX_PtrVertical04"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrVert14_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrVert14_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )


rule PtrVert23_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrVertical02",
                "TenX_PtrVertical03"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrVert23_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrVert23_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )


rule PtrVert24_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrVertical02",
                "TenX_PtrVertical04"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrVert24_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrVert24_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )


rule PtrVert34_rep:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_PtrVertical03",
                "TenX_PtrVertical04"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrVert34_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrVert34_rep"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )


rule PtrVert3:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_Ptr",
                "TenX_PtrVertical03"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrVert3"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrVert3"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )



rule PtrVert4:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_Ptr",
                "TenX_PtrVertical04"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrVert4"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrVert4"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )


rule PtrTens1:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_Ptr",
                "TenX_PtrTW"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrTens1"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrTens1"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )


rule PtrTens2:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_Ptr",
                "TenX_PtrTension02"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrTens2"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrTens2"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )

rule PtrTens3:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_Ptr",
                "TenX_PtrTension03"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrTens3"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrTens3"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )

rule PtrTens4:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_Ptr",
                "TenX_PtrTension04"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrTens4"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrTens4"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )



rule PtrOp1:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_Ptr",
                "TenX_PtrTW"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrOp1"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrOp1"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )


rule PtrOp2:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_Ptr",
                "TenX_PtrOpposite02"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrOp2"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrOp2"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )

rule PtrOp3:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_Ptr",
                "TenX_PtrOpposite03"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrOp3"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrOp3"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )

rule PtrOp4:
    input:
        expand(
            "results/Single_species_analysis/cellranger_reanalysis_{sample}",
            sample = [
                "TenX_Ptr",
                "TenX_PtrOpposite04"          
            ]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_{level}/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            level = [
                "sample"
            ],
            multisample = [
                "PtrOp4"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5] # [5, 10]
        ),
        expand(
            "results/Multi_species_analysis/UMAP_by_species/integration_{multisample}_an_{anchor}_ft_{filters}_kan_{k_anchor}_seed_{seed_use}_md_{min_dist}_nn_{n_neighbors}",
            multisample = [
                "PtrOp4"
            ],
            seed_use = [42], # [42, 12345, 231, 938, 29, 1, 948, 943, 377, 412, 9889, 20, 16, 21, 33, 23]
            min_dist = [0.3], # [0.001, 0.1, 0.2, 0.3, 0.4, 0.5],
            n_neighbors = [30], # [5, 10, 20, 30, 40 ,50],
            anchor = [2000], # [1000, 1500, 2000, 3000]
            filters = [200], # [200, 500, 700, 1000]
            k_anchor = [5], # [5, 10]
        )

